---
title: "Normalizing Flows in GW astronomy."
publishedAt: "2025-09-22"
summary: "Developed a normlaizing flow model to do parameter estimation of lensed gravitational waves."
team:
  - name: "Saqlain Afroz"
    role: "Student"
    avatar: "/images/avatar.jpg"
    linkedIn: "https://www.linkedin.com/company/once-ui/"
  - name: "Dr. Apratim Ganguly"
    role: "Scietific Officer"
    avatar: "/images/projects/project-01/apratim.jpg"
    linkedIn: "https://www.linkedin.com/company/once-ui/"
  - name: "Dr. Anuj Mishra"
    role: "Post Doc ICTS"
    avatar: "/images/projects/project-01/anuj.jpg"
    linkedIn: "https://www.linkedin.com/company/once-ui/"
link: "https://github.com/AfrozSaqlain/GWFlows"
---
# ðŸ”­ GWFlows Project Overview

Normalizing Flows is a generative model which can be used to generate posterior samples conditioned on a GW signal. Normlaizing Flow works on the principle of change of varibables in statistics. To build a normlaizing flow model we take a sequence of bijective functions, which takes samples from a distribution and maps it to a Standard Normal distribution. Since we want the model to be conditioned on GW signal, we give the signal as an additional context to the model. Suppose $f: \theta \to u$, then the predictedd posterior $q(\theta | d)$ is given by the change of variables formula as:

$$
  q(\vec{\theta} | d) = \mathcal{N}(0, \mathbf{1}) (f(\theta) | d) \cdot |\text{det } J_{f_d}(\vec{\theta})|
$$

where $f_d$ represent the FNN neural network part conditioned on the observed data $d$. In the case of parameter estimation of GWs, we define the $\mathcal{N}(0, \mathbf{1})$ to be a multivariate one.

This function $f$ can be defined in many different ways, but in this project we have used rational quadratic spline transform, which conditions the $\theta_i$ parameters on $\theta_{< i}$ parameters, as well as on data $d$.

The loss that we minimize is the Kullback-Leibler Divergence of true vs predicted posterior, which is equivalent to log of the predicted probability as given in above equation.

To generate the waveforms for the training set, we have used the prior distribution, as given in table below.

## ðŸ“‹ Prior Distributions Table


<Table
  data={{
    headers: [
      { content: "Parameter", key: "parameter", sortable: true },
      { content: "Distribution Type", key: "distribution_type", sortable: true },
      { content: "Range / Description", key: "range_description" }
    ],
    rows: [
      ["mass1", "Constraint", "[10, 100]"],
      ["mass2", "Constraint", "[10, 100]"],
      ["mass_ratio", "UniformInComponentsMassRatio", "[0.1, 1]"],
      ["chirp_mass", "UniformInComponentsChirpMass", "[10, 100]"],
      ["spin1z", "Uniform", "[-0.9, 0.9]"],
      ["spin2z", "Uniform", "[-0.9, 0.9]"],
      ["coa_phase", "Uniform", "[0.0, 2Ï€]"],
      ["SNR", "PowerLaw (Î± = -4)", "[10, 500]"],
      ["dec", "Cosine", "[âˆ’Ï€/2, Ï€/2]"],
      ["ra", "Uniform (periodic)", "[0, 2Ï€]"],
      ["polarization", "Uniform (periodic)", "[0, Ï€]"],
      ["Log_Mlz", "Uniform", "[2, 5]"],
      ["yl", "PowerLaw (Î± = 1)", "[0.01, 1.0]"]
    ]
  }}
/>

## inference

While inferring parameters we sample from the standard normal multivariate distribution and apply the inverse flow to get the true posteriors.